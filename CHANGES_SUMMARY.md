# Добавлена Yandex SmartCaptcha для защиты от спама

## Что было сделано

### 1. ✅ Добавлен скрипт Yandex SmartCaptcha в HTML
**Файл:** `public/index.html`
- Добавлен скрипт загрузки SmartCaptcha перед закрывающим тегом `</head>`

### 2. ✅ Создан компонент SmartCaptcha
**Файл:** `src/SmartCaptcha.js`
- Обертка для Yandex SmartCaptcha
- Автоматическая инициализация
- Обработка ошибок и повторных попыток
- Отображение предупреждения, если ключ не настроен

### 3. ✅ Интегрирована капча во все формы

Все 4 формы теперь защищены SmartCaptcha:

#### a) Форма калькулятора (`handleCalculatorSubmit`)
- Расположение: секция `#calc`
- Капча добавлена перед кнопкой отправки

#### b) Форма фиксации скидки (`handlePromoFormSubmit`)
- Расположение: блок партнеров
- Капча добавлена в форму

#### c) Форма записи на консультацию (`handleAppointmentFormSubmit`)
- Расположение: секция компании
- Капча добавлена перед кнопкой

#### d) CTA форма
- Расположение: секция CTA
- Капча добавлена перед кнопкой отправки

### 4. ✅ Обновлена логика обработки форм

Все обработчики форм теперь:
- Проверяют наличие токена капчи перед отправкой
- Показывают alert, если капча не пройдена
- Отправляют токен капчи вместе с данными формы
- Сбрасывают токен после успешной отправки

### 5. ✅ Добавлена документация
**Файлы:**
- `SMARTCAPTCHA_SETUP.md` - инструкции по настройке
- `CHANGES_SUMMARY.md` - этот файл

## Как это работает

1. Пользователь заполняет форму
2. Пользователь должен пройти проверку капчи
3. SmartCaptcha автоматически определяет, нужно ли показывать капчу (на основе поведения)
4. При отправке формы проверяется наличие токена капчи
5. Если токен есть, форма отправляется вместе с токеном
6. Если токена нет, показывается предупреждение

## Что нужно сделать дальше

### ВАЖНО: Необходимо настроить ключ SmartCaptcha!

1. Получите ключ на https://cloud.yandex.ru/services/smartcaptcha
2. Откройте `src/SmartCaptcha.js`
3. Найдите строку 11:
   ```javascript
   const CAPTCHA_KEY = 'YOUR_CAPTCHA_KEY';
   ```
4. Замените `'YOUR_CAPTCHA_KEY'` на ваш Client Key
5. Сохраните файл

Подробные инструкции смотрите в `SMARTCAPTCHA_SETUP.md`

## Опциональные улучшения

### 1. Серверная верификация (рекомендуется)
Создайте API endpoint для проверки токена на сервере. Пример кода есть в `SMARTCAPTCHA_SETUP.md`.

### 2. Обработка ошибок
Добавьте пользовательские уведомления вместо `alert()`:
- Toast notifications
- Inline messages
- Модальные окна

## Тестирование

После настройки ключа:

1. Откройте сайт
2. Проверьте, что виджеты капчи загружаются
3. Попробуйте отправить форму без капчи - должно появиться предупреждение
4. Пройдите капчу и отправьте форму - должно работать
5. Проверьте консоль браузера на наличие ошибок

## Файлы, которые были изменены

- ✅ `public/index.html` - добавлен скрипт SmartCaptcha
- ✅ `src/App.js` - интеграция капчи во все формы
- ✅ `src/SmartCaptcha.js` - новый компонент (создан)

## Ожидаемые результаты

- ✅ Резкое сокращение количества спама из форм
- ✅ Блокировка автоматических ботов
- ✅ Сохранение удобства для реальных пользователей (SmartCaptcha не всегда показывается)
- ✅ Полная защита всех точек входа (все 4 формы)

## Примечания

- SmartCaptcha использует AI для определения подозрительного поведения
- В большинстве случаев капча НЕ показывается реальным пользователям
- Капча появляется только для подозрительных запросов
- Токен действителен только для одной отправки
